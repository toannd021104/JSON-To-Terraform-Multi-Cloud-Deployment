{
  "target": "linux",
  "package": [
    {
      "name": "git"
    },
    {
      "name": "traceroute"
    }
  ],
  "hostname": "toanquoc",
  "timezone": "Asia/Ho_Chi_Minh",
  "locale": "en_US.UTF-8",
  "groups": ["devops", "monitoring", "docker", "toanquoc"],
  "users": [
    "default",
    {
      "name": "user",
      "gecos": "DevOps Student",
      "primary_group": "devops",
      "shell": "/bin/bash",
      "uid": 1111,
      "system": false,
      "lock_passwd": false,
      "expiredate": "2025-12-31",
      "create_groups": true,
      "password": "plain_password",
      "ssh_authorized_keys": [
        "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFakeBase64HereOnlyAsExample comment"
      ],
      "sudo": "ALL=(ALL) NOPASSWD:ALL"
    },
    {
      "name": "prometheus",
      "gecos": "System monitoring user",
      "primary_group": "monitoring",
      "system": false,
      "no_create_home": true,
      "shell": "/bin/false",
      "password": "prometheus",
      "lock_passwd": false
    },
    {
      "name": "ubuntu",
      "gecos": "Ubuntu Test User",
      "primary_group": "toanquoc",
      "shell": "/bin/bash",
      "lock_passwd": false,
      "sudo": "ALL=(ALL) NOPASSWD:ALL",
      "password": "ubuntu"
    }
  ],
  "files": [
    {
      "path": "/opt/test",
      "type": "file",
      "content": "Original file!",
      "owner": "root:root",
      "mode": "0644",
      "backup": true
    },
    {
      "path": "/opt/test-dir",
      "type": "dir",
      "owner": "root:root",
      "mode": "0755"
    },
    {
      "path": "/opt/test-symlink",
      "type": "link",
      "target": "/opt/test",
      "owner": "root:root",
      "mode": "0755"
    },
    {
      "path": "/opt/test-source",
      "type": "file",
      "source": "https://raw.githubusercontent.com/canonical/cloud-init/main/doc/examples/cloud-config.txt",
      "owner": "root:root",
      "mode": "0755"
    }
  ],
  "exec": [
    {
      "command": "echo 'Test file created at '$(date) > /tmp/test-app.log",
      "creates": "/tmp/test-app.log",
      "cwd": "/tmp",
      "environment": ["TEST_ENV=production", "TEST_DATE=$(date +%Y%m%d)"],
      "onlyif": "test -d /tmp",
      "timeout": 10
    },
    {
      "command": "echo 'Directory listing:' && ls -lah /tmp/test-*",
      "unless": "test -f /tmp/test-app.log"
    },
    {
      "command": "echo 'System uptime:' && uptime > /tmp/uptime.log",
      "onlyif": "test -w /tmp"
    },
    "echo 'Simple command without options'"
  ],
  "ssh_config": {
    "ssh_deletekeys": true,
    "ssh_genkeytypes": ["ed25519", "rsa"],
    "ssh_quiet_keygen": true,
    "ssh_publish_hostkeys": {
      "enabled": true,
      "blacklist": ["rsa"]
    },
    "allow_public_ssh_keys": true,
    "disable_root": true,
    "disable_root_opts": "no-port-forwarding,no-agent-forwarding,no-X11-forwarding"
  },
  "bootcmd": [
    ["mkdir", "-p", "/run/early-setup"],
    ["sh", "-c", "echo 'bootcmd started at $(date)' >> /var/log/cloud-init.log"]
  ],
  "power_state": {
    "delay": "now",
    "mode": "reboot",
    "message": "Rebooting to apply package updates...",
    "timeout": 30,
    "condition": ["/usr/bin/test", "-f", "/var/run/reboot-required"]
  }
}
